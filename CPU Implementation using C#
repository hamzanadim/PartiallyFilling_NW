using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace CPU_Partial_Needleman_Wunsch
{
    class Program
    {
        static short Gap = -8;
        static short MissMatch = -1000;
        static short Match = 10;
        struct Cell
        {
            public int Score;
            public char Direction;
        }
        static void Main(string[] args)
        {
            string seq1 = "AACCATGAGCGAGTACTAACGACCTGTTTCGAGCGCCCCAGCATCTCAAGGTTGGAGTTTTCGTAGTCGCTACAATTTATCCCGGCAAGGATTCATAGCAAACGGAGTACACCTGGTTGCACGAGAGATGCCGATCTAAGGATCACATGTTATTTGCCAACAACTGGCATGCTAGATCTTAGTTCCTGAGTGATCAAATCGCTGCAGCGTCTCAAGGAAGCTGCTTCACGTCTGCGGGACGAAATATACACTAGAGAGCCCAATATTGGTTATGACTGCTAGGGCTGCAAGATCAATAAAACCTACTCGGCTCCCACTGAGGAGCTAGGACCACTCCCAAATGCGGGATTGATACCGGGGGGAATTTATAGACAACAGTACACGCCTAAAAGGTCCCATGCAGTCGGCTTCACACGTCCAATATTATTCCTTGGCGTTTGGGAAGATAAACTCCGTAGTGGGTGATCACACATATCCTGTGTCGTTGCTCGGTCTTGCTCGCGACCAGTCAATAACCCCAGTGTTAAGAAGAATGTGCTGTATGCGGTGGATATACGGGGGTACGAAACGAACGGGTAGCTGTTTCAATTGAGCATTGTCAGGAAAATCTCGTTGTAGCTTTGTTACAGGCCATGCACCTGGCTAAACAATGCACAAGGAGAGAGAAAGTTGTTGCGGCCAATAGATTAAGCGCGATGCATTAAACCTCATTTCAGGGTAAGTGCATGGGTTCCCAACACCAAAACTTCATCCCTCATCTTGGGGAAATTGCGACTACATGTCAGAATTATAAATGCTTAGCTCTGGCATCGCTGTCGAATAGTAACAAGGGCTCTAAGATCTTCGGGCACGCTGAAACTCAGCCATCACTCTAAAGCGCCGCACTCTCGTTCCGTGAAGCTAAAAGCTATCTAAGGAACCTATCTAGCATAGATTGCTCGATCGGAGGTCAACTTTAGAAATCATATGGACGGGCAGGGTCATCTTTGAAAGTCGAGCCAGAACTCCAGTGCTGGAATATGCGAAGCTTGCTTGCCTATAACAGCCCGAGTGGCTTTTCCACGTACCGCTAAATTCCACCTATCGACGGTCAGGTCGAAATACAATGGTAGTGATATCGTAGATGACTTAGGTGCCGTGCTACGCTCACTTCTAACATTAACGCTTTTCACTGTATCCGGGCAAGCCCGACCTAGATACCATCCATGAAATGGCTGGAAAGACGGATAGTAGATAGACTCGGCAAAGGGTTCACAAGAAATACAAGGCGGGCAGCTGGAGTGTGAGGCCAATCTCGTCACTCATCAGCTACTTCGGAGACTTTAACAGTGATGCCAGATTATCGCGTTCGAGCGCTTTCAAACCATCGAAAACACAAGCTCACCATATTCGCGTTAAAGCCCCCAATCTCCGGTGTGAGGCTCCTCTTAGTAATGTGAGATCTATAGCGTCTCAACTATCATGGTCAGGGCATGGAACCCGGCATTGTTCAGGCTAAGGATTATGGAGTTCGGAGTGGCTAAGTGATGGGTCACTGGCCGTAAAACTGAACTCGACCGGACTTGATATAACTCGAATGCTGCAACAATGACTAGCTATTAGAATCTAGAACGCCTACTCTTGGAGCCACATAGCCGGGGTTTCGCGGCCCGGAAGTCAGAAACAAGTTACCGGTAATTGAATCTCCAGACCGTGCTACGAGGCAAATGTGACCGAGGTGCGCTGTGGAAATACGCCGCTCCTGTGTCGGGGGACCTCAATCTATGTAACGTTTTTGGATACTCCTCTTCTAAGATTCGGCTCTAGCGGTGGCAAGTAGATTAGTGTGTTTCTCGGAACGAGGTGGGTGTATGGCCCATCCAGCACCATTACGATGGGAGTTAATAGGATCTGATATTTTTGACCGGACAAAAGCCTGCTAATTAGGGGCCGGACCTCCCTATTTCTTGGACGACTGAGAATTTCCTTTACGCAATAAACGGAACTAAGCACAGGTGTGACATACTAGTCCGATTCTTGCGCGAATAACGCATTTAGAGCTCGCATCGGTTGCCCTCTACCTTCAGGATCATGCCTGCAAATCCGACAAACCTCAATCCCGCGCCAATATCACTCCAAGTTGTTACTTCGTTACCCGATAATTGGCATAGACACCACCCAGGGCACTTGTAAAATAGCGCGTCAGACGTGATCCTTGAACCACGAACTTCCTATCGCAGTAGTTTGCGGACGGCAGGGAGCCCGTATCACAGCGCAACCTGACCTGGGCGTGAAGGTCACGTGCTACAAAGCTATCATGGCGACCTGCAGGCCTGCCTTTTGGCTAGTGTGTATTATCATTTATCTATCATAACGGAGCCGCAGACGTTGTTTTAAACTAACGATACCGGTGACGACTCAGGAAGTGACGGGCCGTATGTTTGCGCTGCTGGTCTCGATTTCTAACCCACACGTGCTCCCATCCATCTCTGAAGAGTGGTTGGTTCAAGGCTGATTTAAGTTTGATCTCACCACTCCCTGTGCGAGCTCGGCGATACATTTAGGCATCGAGGGCGGGGACGTAGCTGATTACCACCAACACTGCAAGCCGCATGCTTACTCCTGTCCAACGACATGGCGGGTGGAACGCCTAGTGTTACGCAGAACGTGAGGCAGTGCGTTACCTGCTCTCGTATAGGGCCTTCAGGACCCGTTGGCTGCTCACGAGCGAGAGCGTGAGGACAAAGCACCCGACCTTGAAACTGACTACCACCTGGGAGAGGATCATCAGAATGGGCTTCGCGACTTAAAGTTACCCATACGAAGTTGCATCGTCTAAGCATGTTAACCCTCTCTACACCACGAGCCAGTCCTGTTTAAATACAAATCTCGTGCGCGGGGCAGCAGCCTTGGTGTATGTATAATCTAAAACCCTCTCTTTGACTATTATACTGGGCTGAGACCCGTTATACTCACCGGCTTAATGTAGCTTGTCTTCACGATATCTGGCCGGTGGTGCACCGGTAGATATAGTACATAGCCTTACGGGGTGATTTCGATGCGATCACCCATGGGACCGGCTCGGGTGTAATCGTAACAGGTTCGTACGTAATTGCTATGCTTGCAGACGTTCTATTTAGGGTTATTTTGAATCTCTGAACAAATACATCCTTGTGTAGTGGAAGTATTGTCTATGATTTGTAGCAAGTCTTAGTGTTTTATAGCTATCCAAAGGCACGATCTGCACCAGGATTTCCCCTAATACCCCTGAGCCAGTTTCGGCAGTAGCTTCTCACTTCTCTTTGACGTGTTTAGCGCTCGGTTGGGTGGCTATACCTCGATGGATTTGCGATACATTGACTTGCTCTACTCTCGCTCTGCCGTAGAAGTCTGCCGTTTGGTCCCCGGCTAGAAGAGAGATCCAAAGATACTTCACTCACACGGCGCAGGATCCCCGGCCAAGCGACGTTGCATTAAACTGATCTTGAACAGTGGAATAGCAGCTGCCCGGGTTATATCGTGGGCTCCGTTGAAAATGCCACGCATCAGCTGACCGCTTTCAGTGAATTTTTAAGATTGTGCGCTGACGTGTCCATGCATCCAGCTAAGCGTCACTTCTAACGACAGCTGTGCGATCTAAATATGCAGAAACCACAGATCCCGATTAGTCGTCTTGGGCTTTGTAACCCAGCAGGCCAACGTGGTATTGGCTGTTCAGTCGCCTGCTGGGTAGACTGATTATGAGGAGGTGAGGATGCTAGCGACCCGAAAACTGCAGCACGTCTCTTTTGTACCCGGCCCCAGCGCGTCCATTGACTAATCGGTGTTGTATTAGAGCACAGAGAGAGGCTCACTAACGGGCATGCGTGGCATGTCCAAGGCCTACCAAGTCATGGAATCTATTTTCTCGCTCTACAGTCTACAGATTAGGGACCATCTGTTCTCAAATCGTAGCTCCCCTTCGTATTGTTCGCCACCGGACAGACATTCGATGGAAAACGACTTCGCCCGTAGCACGAGTTATCCTAGGTGCTTAAGCCACAAGCAGCACTTCCGTTGATGAGTTGGGCAACCAGTTCTCGGACTGTACAAAGTCGCGGGCAATCAGCGGAGGCGAACTGGACCAAGTCTACACTAAGACAGTGTTTTGGGAGTTCGCTCTGTGACACCAACGGGAAGCAAGCGCAAGTATCGCTTCCAGTAAAGCCACTGATCGGCCTTGCCGGCACGGCCAGGAGGATGACATCCTGGAACGTAGCTTGTCAGTAGGAAACTCGACCCTGGAAGTTCACCCACGGGTACAGAGTGTCGATAATTCCATTATACGCGGAACTCTCAACGAAAGATCCGCTTGAACGACAGACCGGTGAGTCTCTCACACCTATGGATGGGTGCTTCGTCTGGACATCACGCATGGATGAAAATTAAGCTACCGTGCTAAGCCTTCCGGCCTTTCTGGAGTGTAGCATATCACGCCGATGCTAAGGTTCAAATTAACGCGCTGGTGACGTGACCTAGTTTTGAACCGCGCAACCTCCCGTAAGCCACAATCCCCGACATAACGTTACTTACTGTTCTGGCTACGTGCTACAGTATCTCTCGCATGTGCTCGGTAGATTTCCCTGAGTGAATACTAGTTAATAAGATCCTTTACATTTTTTTACTTACTTTAATTCCCGAATGGGGTGGTGGATAATCGCAACCTCTATCGGCCCACCAGACAACCAACTCAACAAGCCCCCCTCTTGATCGGTGGTGTGGCCATAATGCTTACTCAGGTCCTCAGTGGTATCAATTCTGTAACACACTCGGAACTCTTCGTCGGAGTGACGCATCCGCCAAGCCCTGCGAATGAAGCATGGGTATTAAAAGGGGAGTTTGTGATCCGTTATACACTCCCCTACATCCTTTCTGCCAAAGGCAGTAACATGCGAACCTTTTTCAACATACCCGAAACTCTTAGACAACAATGGACGATAATACGACAGATTCATTTCCCACCCACGGGGTACCGACGATTTCCGAGAGGCTGGACGGCCCGTTATATCTACGCCATAGTGATTTTCGCTTGCGACTCGGTGGCAAGTCTCATCGGGTAGATGTATTAGAGATTAATGTCGTCCGCGTACATCAGATCCAGGGGCGAACACAACTGACCGCTATAGCTCTGATTAAGGATCGGTATTAATTAAACCACGGTGGCTGGGGCATCCTACGCAGCCTAAACACACTCAGTCACCCCCTTGGGGTTTATACCCCGCACGGTTCCGAGACTTTAACTGTCGTTTTCGTGGTCAAGAGCTATCTCAGCCCAGGGTACAATTAATTCATTCAAAGTTCTGTGTCGATGGATCAGTTTCCATTGTTGTGACACCCGGTGTTTGTTTTTTACTAATGAAATTGCGTTGAGACTCTTACTCATCTACCTGTAGGTCTGGTATGTCTCCGAGTTAGTTGGGTATAAATGAATGTCCCCATAGTGCAAGATTCCTTTAAGCGTGGGGTTACCATGATTCATATCGAGGCTCGCGGGGACAGAAACACTACTAGTGGCATGATGAGAATGATTGCCTACAAGGGTACACATCAGGACTTTGATCTTACTGCGATCTCGGACAGTCGTGACATACTACTGATTGGGCGACCGAGTAGCAACTCCGACAGACATAGATTAGTTCTCATGACGGCCTAAGTACGAATGGAATGCCCACGTAAGGTTCGCAAATGTTCCTCTACTAGGTCTCATGGTTGGAGCTGTATTTTAGCTATCCACGTTCGAGCAAAGACAAGGTAGGTCTGGAACAAATTGCATTTGTTTTGACTGGCAAAAATACACGTTAGTTCGGAAACATTTGCAGTGTCCGCACACTGATCAACGTTCTAGTAAAACGATGACACTGTTCAAAAATGTTGATACAGGAGATCGAGCGTAGCACGTGTATGTTCCTCAATACGGTCCCTTCCGCGTTGCCTCAGAGATCGTGGAATGCTCGCTGATGAATTGGGAGGTGCGCACAAAGCGCGGTGACTAGTACTGGTATCGGGAGCCGGTCAGTAGTCATTGTACGTGACGAGAAGAACCCACGCTCTCACGTTCTCGCTCAGCCCCGCTGCTGGCTGGTTTTATTACGATTCTAGTTCAAAGCCACCCAAATCACGGTTGAACACTAGATATGCCCAGCACAGACTACGTCTTCAACGAGGACGAGCTGAGTACTACCGCTGTAAATCCCACGGTGGATGGAGGCCTGTAGTTGCAGGATGTGTTCCCTGCCCAACTCGCACTGAATTTCAATAACTCGAAAGGCCGTGTACACCCATCTCTCAGCCCTCTGAAGAAGTGTTCACGTGGGCTTCGGGGATACTCACCTACCCTAATACGTCAGCATGCCACCGTGATTTTTAGCTTACCCACTAGTGGCAGAAATTATTTTGCGAGTCTATCTATTCGCCTCACCCAACTTATCTCACTTTCGGGCATAAATGAAAATTGGTATGCCAGATACCCGGTGACAACTATCCCCACGCAGGATTTCTATATGTTGCCTGTCAATACTCTGATCTTCGGCGAGTTAATCAGAGAGTATATGTAGGTTTATCGGAACAGGCTCACGGCTGTTTAGGCTAGTGGTCGACGACTTCGACTCTAGTCGATATTGTTTCGGTGAGTGCCTTGTGTCGAGCGTCCCTCCCTTTATCCGCGATGTGACGCATCTCTACGTCGATTCAAATTAGCCACTTAGTCAGTGAAATTACATAAGGGAGGTTCTAGAGTGCCTAGAGTTAATTCCCACCGTAGAGCGCTTTCATAGAACGTGAGGAATAGGCCGGGACTTCTTAACCTCGCATACGAATACGGCGGTCCCACATTAGTATGAGTTACCTAGTTCGAGGCTCAGTAATAGGTAATTCACCACATGGGCCCCCAGAAGCCCTGCAGAATTCCATCGGGGTGTGAGCTTTTTCACTTTATGGAGTATCTGTTCACATGGAGCAGTAACCTCCGCTCAGGACAACAAACGGAGCTGTGTCTAAAACACAATAGAACGGCGCTGAACGAGATAATCTGATTTCTGCACGGGAGCCTTCTTGGTAAGCTCGGAGCCGAAACATTTATGGCTTGGACCTGTATGAATATTAGTCCATGCAAATAGCCTTATAGCGTTTTCTAACGAAACAGATTGCACTGCTACTTTAGCGACTAAAGTACGGCTTAGGCCGTGATTGCGAACTTGGACGGTCCTACCTATCTTTTAGCGATCGTCTGCGCTTAGTCAGAGAGCCCGTTTATCGACGGCGGGTCGTTCGAATAGAAGACGGTGTACGGACGGGATTGTATTCGTTGTAGAAACGAGTAGTCGCTCTGACACCTTGCGCTTCATTGACATGAACAGGTCATTTGGGCGTTGTAACAGCCGCAGAGTGATCATTCATTTCCCTTAGGTAATTTGACCCTAGTCCATCACACGCTACCGACTTGTTCACTAGATCACAGCATGGTGCGTAGTGGAACGCCCTAACCGCTTGCACATCCGCGAAGGATTTCCAGCAGCACGTACATTTTGGGTAAGGCTCGCCCAGAAGGCAGTACACAGCGAGCACAGATTTCACGGGCCCGCCATTTGGCGGTACAATCTTGGTGTCCGTAGTATGCCACATTAGGCATAAGATCAATCAGGAGCACTAAGCTTCTGACAGCCACCGTGTGTAAGTTCCGTCTCCCCAATCAACCCTTCTTCGATCCCCTTTGGACCTGTAATCGACGGCATTTCGGCTAAACATTCTGATTCCCCCCTCTAATTATGTTGAAGTACTTGCTAGCAGAGTCCCAGATCATTAACTTCGTCATTGAAACATCCATACGTTTATCAGGCGCTGAGCTTTGAGTAGGAAAAGACTGACAGTTCGCAGGGGCAGCATCTTGATAGGTGACTATTGAGGTGATACTGAACCTCACCGTCATCCGCCACGTGCGCCTGTAGAGTTCTAAGAAACAACGCGACCTAATGACTAGCGACCTC";
            string seq2 = "TCAGATGAACTGCCATGGTCCGTGGTTGGTGTCAGGCGTGTTAGCGGCCCTGTATCCCTATTTGAACCACATCCTTACCACGTCTAAGATTTGCGATTGCCTGTGACGGTGAATCCTAGTAGCGTGGAACTGAAGCTAGTGCAAGCTCTTGTCGCGAATTCCATTATTCTCTCGGGAGTACTAAGACTCTGTACGTCAAGTTATGGAATAATGTATGAGTGAACGTCAACTAAGGTCGTTTCTGCCCGGGGGCGATCGGGTAAGGACTGGGAGCACATATGGCCAGGTGCAAAGACCCAGTCTAAGAAGGCTGGAGGGAATTCTGAAACGAGTCACGCCTGACTTATCACAACACTAACAGTCTAAACGCTTCGCTGCTAACTTAATCAACGTGCGCCCCAAACCGGGGCCGACTTTCTAGGCGACAACGATAGATCGGCCCGGGAGGCTGACCGCCCGAGACACTGTGTGCAACTAATTACCTTAAGTCGTTAGGTGTCCCTCCTTCACCGCCTCCCAGCTTTCGCATATCGGACTAGTGCGGTTGGGTTGAGATCTTAGTTTCTAGGGCGAGATCCACAACTACCAAGTAAGCCTGCATTAAAGATAAAACGAGATTAAAATGGGTCCAATATATCTCGTTTGCGTAGGACGTTCGCCAAAGATGCGTGCAATGAGCCTGCGGTCCAAGCTACATCCGGTGGTTACCGCGCATCCCAGGCCGGCCTGCCCCAAATGGGTAACGAATGTCAGGACAATGAAATTACGTCTAACGACTTGCTCCAGAAACTCCAGCTGTAGCTCAGACATTGGGTGGCCCACAGCACTGCAGATTTTAGCAGAGCCGAGTGGCAATGCAATAGGCCGGCTCGAAGCCTTACGCGGTTTTACATGCTATCAATCCGTGCCGGGTTCCCTTTCCCGGGGCGCCCACTCCAACGGAGTAGATAGATTGCGGGACCAACCGAATTCTGGGGAGAAGTGGCTGGAGGTTACAATGTATTATGCGAGATAAATCTACATTCGCTGTAGGAGTGTGCAGTATACCTTTCGTCCGAACACACAACTTACTGGTGACTCTTTGACTCGCCGTCGCAGATGTTTGTAATGCCACTACTGCAACACAATTGATGTAATAAGGTTTATAATGTGTCTGATAACAAGATGGCCAGCAAAGCATTAACGTTCACTATACGTGCACTGAAGCCCTTCCGACACAGTCATTAGCCCGATTGACAGTAGAACGGCAAAAGGGTCCAATAATGTCCAATAAAACCAACCTGGCACCCGGATGTAAACTCTGAGATAGCGCGGGACCGGAAATTCATGAGGGGATGGACGCGTTCTGTTGGTGCCCCGCTATGGAGTGCCACTACTATATCTGCTCTTCACAGCATACTAATAAGTAGTCCTATAAGCGCGTTCTTAATTTCTTTTCGGAGCATCTACCTGGGGCAACAGCTCATTTAAGCTGAATTATATCCTGGAGGCTTATGGTTTCTAGAGCTAGTGTTACAGCTGCGTCCCCGCCTTAAATAGGTCAAGGTAAGGAGACTGATCTTCGCTGCCTCTTAATCGGACCCTACCTCGTCATCTTCGCAAGGCCAATTGATTTGGCAAAGAGAACACATATTAGAAACGCACTCTGTACGGAGCTAGCTTCTTAAACGGAGCTCGGGGAAAGGCCCGGCATCCGTATCGTTGTCTTGTGGCTCCCAGGCCCATAATTGCACCTGGTGTCTGCAAGTATCTTGATACCTGATTAGTTTAGTTGTCGAATCGTTCTAAGAATACCGAGGCACATCCAGCCCAGCAAGTAGACGTACTATGCTCGCAATGTTCCTCAGGGGAAAACCAACATTCAACGAAATGCGGGACAAAGTCGGTCTTTAGGAAAGTATGGGCCCTCACCACTCTATCCCAAATAGAGGCCAATAGACCATTGAACGGAACAGAAAGCCGCGCATTGTGCAAACTGTTTGTCGGACTACTAGAGGCAGGAAGAGTGACGCGGTAGTTGTGAGACCCTCGAGGCCAGCTGCCATTCCCTAGCCGTATAGTGGGGAGTTATTAATGTTGGTTAACTCCACCGGGAAAATTCCTGTAAGTTAGCTGTAGTCGTTACCCTTTGTACCGATAGCATAGACGTGTCAGCTTCTGCAGTCGGAGACGGGTATCTGTAACTCCCATGCATTGCTCATCACCCGTGGTGTGGGATTTTCAGTTGCGGGTACCAACAGGCGCAATCGCGTACGACTTTACGTTTAACAGCCCGAGGGCTCATACTCGGCGCGACGGTAATAAATAGAATGGATCCCTGTCCACATGGCCTCACACACGGGGACATCCCATCGGGATGATTAGGATGGCAGTGAGGCCGGGTTCTAACGTCCCGGGTCGGGATGTAAGTACGATCTATCTTCACCTGTCTGTAATAACTTTCTAGACCTGGTACCTAATTCGTTCTATAGTCATTATTGGGCAACCTCGAATCTACCTCCTCCCGCCACGTATGCAATGAACGTAATGCACAGTGCAGCTTCTAAATGAAGTCCGAACGGTGCGTTCTTATTAGACTGTAAGACTTGTGAGGAGACTGGAGTGAACCAGTGTTGAGGACAGTCCCCTTACCGACCAATGAAGGCTCGCGCATCGCGGCCGTTTTGTCACTGGCCTACATAAAGCGTTTTATGATAAGGGTTGTGGCAAGCTGCCGTGGCGATGGATGTCTTATTATAAACCTGGAGCCCGCTTTTTTGGCGGCCTTCTGGCGGATGCTACACAAATGAAGTCTGAGGTCGTTGGCGCCTCGAACCTAGCTCGCAGTGTAGATGTCAGTCCGCAGATGATAGTGTCCAGTTTCCGCGCGAGCACTGTGGTGGATTAACCAATATTCTACTCAAACCAGGGTATGGGCCCGGTAATGCATACTCGGGAAGGTTAAGTTCCGTAGGCCAAGATTGGTTCCTAACGGGCTTCTCTCCAGGGTCAATGGACTACGGTGAGTATTTACGCAGCACGATGAATTTGAATACGAGGTCGGTTTCCTGTTCCAAGGGAGTGCTTGCCATTGGTTTACACGAGCGGATGTCAGGTACATCATCCTCGCAGGTAGACTAGGACGGGTTTATATCGCGCTCTACCTCCTTGAACCCCGCAAACCCGGGGTTCAAGCGCAGTCTTCTCGGTTATGCCACTACAAAACAAGTATAAGGACTCTTAGTCCCGCCTCTTTCTTTCGAGTTTTAACGCGGCTCAGACTCGGGAACTATAAGTTCTCCCAAAGGCGTTTGTACCAGCTTGGGGCATTAAATGTCGAATCTTAGCAATACGGTTATCTTATCCTCGCAAATGCAACAATGATCGTTTGCCTGGTCAAGCAGTTACTCCTCCGTGATAAATGGGGACATCTCTGCTAAGCTAGGATGGTCCATGTCAGGTATTAAATTGGTTCGACATGCTGAATTCCCTCCTCCAGGGTAGTGTTGGAAGGACACCCAACGGGCATATAATGGCGGTGAGAGGGGCACTCTGAGCACCCAGCAACTTACGCATTGATTGCCCTGGCATTATATATCAGTGTTTCTCGGACGTGTGTTCCACTGCCCGTTTTGAATTCACCATTGTACTTACGCCCTCGAAGGGACTCGTCACTATTATCCAGATAGCGGTAGACACCCCAGGAATACCCTTTCCAAGGAGAGTAGTCGTAAGGCACGTAATACCAACGGAGACATTGATTCATCCCGAGGTGGTGACGTAAATCTTCACAGGAACTGATCTCTAGTTCCTGTACTGAACCTGGGACGAGCTCCGGGATGTAAGTTGACAACAGATGGCTCCTGATTGCAGAGCTCTTGGTGTTGACAGCTAGTTAGTGAATGCTTGCCGTCTGAGTTTAGCTAAGTGTCGACGGTTAACCTGACGAATCGGTGCGAGGGAATTATTCAGGCCGGGATCCACCGATAGCTTCTCGCACTCCCAGATCCTGAATCGGCCTATCAAGCCTTTGCTTAGGAAGACGACCTAGAAGCTCACTTGACCAACATCTAGCGTGATCTTCCTTTTAAATGACGCTAAAGACCTCTGAGTTGACGATGGCACCTCGTTGGTCCGTAATATCTTAAATATGATTGGGTCGAACCATATTTGTTAGAATGTCCTTTGATAAGACCATAACGTAAGCGACCGACGCTCGCTTCGTTCAGGAGATAAAGGGGGACACTCCTTGCGGTCGGGTGATGAAAGACGATGGCAAATTGGCCTCCACCAACTGGAACCACGGGTAAGGGAGTTCATACCACAATAGTGAACACTAAGAGGTGAATTTTAGTTTTTGGGCTATAGCAGACACAAGGATAAGGAGTACGCTCTTGCGTATGCGTATTTTCCTCAGGGACGATTCATACCGTGTTCGTCTGAGTCTAACGAGAGTCCTCTATAAGCGTCGAGCGGGTAGTTTGGGATAAGAGATCGAAGTCGCAGTCTTCTGCTTGGTCGTGCGGCATCTACTGAGAAACGTGCGCTGAAAACTAGCGTCCTATGGGACGAACTTTAATCCTTCTATAGTTTGGACTGAAATCCAAGCTAACGATCTCTGGGTTCGCGCAACTTGTGACTCAAACAGACCTGCTTTACATGAACACCCTTACAATAGCAGTGTAGCAATCTCATCGACAAGCGCGAAGTCCGCCTTGTAGCCCAAGCGCCTTGATATACGGCAGAGACTCTAGCGTTGCTGTTGCCAGCTTAGTTTGGACGTGTCTGTCAACCCTCTCCGGCTATTTCCCGCGTCCCTTTGGTCCAGCTGATTCGCTGACTTATCCGTAGTTCCAATGGCGGCACCTCCTCATAAGATTTTCGCGGAACATGTCGGGTGATCAATCAGCTTTCCCTTATAGCAGAAGATCAGGCAAGGCCGTGTATTGTCCAAATACCTCGTCTCCCTGCGCGATCAGGGAAGGATAATTCCGTGGACACGTTGATCAGGTGGCCGCGTTGGTCACGGCCGCGCTAATAGAATCTGACGATTCAATTGGGCGGCTGTCCGACACCGGGCTGCTCCCTACTATCCCTCATCGGTATGCAGCCCCCTTGTAAGTATAGTCTTCACTGATTCGATCTGCAACTCTACGGGAACGAGCTGTTATAGACACGAGCATTTGTAACACCTAATGATACGACTACGGCAATGCCAGAAATAAGGCACAAAGGTCCAAGACTTTGTGCCTTTTTTAAGGGCTACATGCTTTGTTCAGATCACTGAGGCACCTCTCCTGTCGTCTTCAAATTTCTGATCGCCTGGAATTGAAAGGAGTAGCAGGGCCGCCGCATAACGGCCCACACTCGTTGTATCACACCTGGTGAAGACTGCTTACATTATCCATTACTTGCATGCTTGCGAGTTAGTCCGGTGTCTCGGATGCCTCTGGTGGATTGCGTGATGCACCTTTAGACCTTAAGGGACTTTGAGAGCTTTTTCATACCCAGGGAGGGGTTTCCATGTGCTCGCCTTCTCGCCACGGAATCAGTAAAGCACGGTTCATCACTGTCAAGACCACCACAGCCCCTTTAGCGAGCGTGCTCGATCATCCCCTAGCATGATCTGCGAAGTTTGGTCACTAGAAGGCTACCGGCACGCTGGCACTCTGCGCCCAGCTGCATCTGCGGGACCAGAGGAGGCCGGTTATGACTTTTGTCTAGGCGTTCGGCTCGAAGCAACCCAACTCGGCCTGGTAATGTACGCGTGTTCTCCGCTGGTAGGTTAAGTATATTAGTACTCGCGTTTATTATTTACTCCGACGTTGATCACCCCGTCTTTGTGATTGTCGGACGCATTCCTTCTACGACGATCCTAAGAAAAGACCTGAATTGGAGGGTACAAAGGGAGCTGCGGCCCACTTAGCACGCGTTCTGTAATGATAGGGATAGTTGAATACCATAGTCATCACCGCTCATCTAACAGCAGCTCCGCTCAGATGCGTCCGAGCATCCCTATTGCCATGTATTGCCTTCGCTCCGTTACCATATGAGCATCGCTGGAATCATAAGAGGACCAGCCGTATGAACCCGGTGTTTAACGCTCGTACGACATATGTGCGAAGCTTCAATTTGAATACCCAGACAAGCGGTCCCGGGGCGAAGCGCCTAAGGCTGCTTGCGTCTTGGCCTCTAAGTACACCCCAACTCGTGGTTAGGCTTGAGACGACGCCGCTATGCCACCGCGATGAAGGTAGGAGGCGGATGACACATTACGCCCCCGTGGAGGGGCCTAACACCGAGTCTGGGATTCGTTACTTCTTGCTGTTTTATAGGACAGTCAACCAGAGTAGCTGGAATCGCGGCTCAGCCGGTATCCTTATCACTGGTTAGGTCTCTTTGATCGTTTTGTGATGCAACTGAAGCATCAAGTCTGTTTCTTCCGATAGGACGAACGAGAGAGCCAACACCCGGTTTCTGTTGAAGTTCGATCTGTCATAAATTTCGTAGCCAAGGCGGAGGATGCTGAAGTCCACTCACATCATGCGCAAGCTTTAAGGCATTATTCTCCTATAGCTTAACCATTATCGCCATTATTATCTCAGAATCGAGGGGAGTTATTTGATCGTACCCAGAACCCTAGGGAGTCTCATAACAATGCTTCTGCATAACGAACCCATCTCAGCTGATATTAATGCCTCATGTACTTGTGTTTCGTGGCGAAAATATGGATGGGTAGGTAGCTCATGCCCGGAAATACACTCATCCCGCACTGCTGACAATGCTCCAAGATCAGGTCTAGATTCAGTCGTCCCACGTGGTGGACATCAGACGCCTACATATCTGGGTACTTGCAATCAGACCAAAGAAGGTTGAACGCGTACGCGGCGCTCGCCCAGTGAGTTGTTTCAGGTTCTAGCTTTCGGCCACCTACGAGATACGGTAGGTCACGTTACACGGCGTAAAATGCATAAAGGTGATTTATAAGCCTTCCCACACAACGTTTGCCCAGAGGCGTAAACGTCGACCTTGAGTGGAAACGCTGCCGATCTTCTCACAGTCTTTTATGAAGCAGCTGGTTCCTATGCGGATTCAACTTCCCAACGGCAGCTAACAAACTCCGTTGGTTGAAGTGAGGGTCCGATGCCAATGGATTGGAAAGTTGCGGTCCCTTATGGTCCCTTCCCGTGCAGACGTGTGAGTGGAGCTACAGCGGCTGCTTGGTCGTATATGCGGCGCGGAGTTCCTCGCATGGATCCCTCCAATCTAACGAAGCCCGATGGCGATAAGGATACCCGTAATTGCATTACCGAGTGGTCATGCCCCCAGCAATGAACTAAATACCATCGGGTCTACGATTCTGGCGCCACCGCCTTGTTGCATAGGCTGCCCAACGGTAGCAGCCTAATAAGAGGCTGAGTCGGAAGCACCCTCCGCGCGACAAGGGCTTGACCGATAGCCCAGCCGGCTACCCAGGATTCCTAAGTGACCGTTTCCCCTTATTTTGTCACTACTTTTAACAAAGCCCTCCCGATCCTGGAACTTCGGTATCCCATTTCAGCAACTGTTGATCTACGGACGGTTTAATATTTGAAGTCGTGGGCATTCCGGGCTTTTAAGTCTTCACCTCCCTGGTTATTGCACCGAGAACTGAACCCTTGGCTTCCGCAACGGAGGGGGAAGTATGTACGGATCTTATTCCTAATGAATAAACTATTTTGTGATCGGCAGGCCCGGATGCACGGAACAGTTGTGTGCGGGTGTGTCCAGTTACGGAACCGTGGACACATTCTGTCCCTGGCCCGATCCACGTTTGCATTTAGGGGTTCTCGAGATGCATTGAAACCAGCACTACGGGATGTATCAACCAATTAACTGATTTGACTCATCCTCACTAGCTGTGAGACTATCTAGAGCAACGATTCAGTGAGCCGGTGGTGATTTACTATAAAATGGACGATTGTCTATTGAAGCGCATCAGAAGTAGTTACTTCCGCAGGGTACAATCCTAGTGCTTATGG";
                
            float percentage = 0.6f;
            Align(seq1, seq2, percentage);

        }
        static int Align(string sequence1, string sequence2, float DesiredPercentage)
        {
            int f = 0;
            double StopDiagonal = 1 - (Math.Floor(Math.Sqrt((1 - DesiredPercentage) * sequence1.Length * sequence2.Length)) / sequence1.Length);
            StopDiagonal *= (sequence1.Length);

            Cell[,] Matrix = new Cell[sequence1.Length + 1, sequence1.Length + 1];
            Initialize(Matrix, (int)StopDiagonal);

            int x;

            for (int y = 1; y < Matrix.GetLength(0); y++)
            {
                if (y <= StopDiagonal)
                    x = 1;
                else
                    x = (y - (int)StopDiagonal) + 1;

                for (; x < Matrix.GetLength(1); x++)
                {
                    f++;
                    double koko = Math.Pow(StopDiagonal, 4) ;

                    if (Matrix[x, y].Direction != 0)
                        break;

                    int up = Matrix[x - 1, y].Score + Gap;
                    int left = Matrix[x, y - 1].Score + Gap;
                    int diag = Matrix[x - 1, y - 1].Score + MatchChars(sequence1[y - 1], sequence2[x - 1]);

                    int max;
                    if (up >= left)
                    {
                        max = up;
                        Matrix[x, y].Score = max;
                        Matrix[x, y].Direction = '^';
                    }
                    else
                    {
                        max = left;
                        Matrix[x, y].Score = max;
                        Matrix[x, y].Direction = '<';
                    }

                    if (max < diag)
                    {
                        max = diag;
                        Matrix[x, y].Score = max;
                        Matrix[x, y].Direction = '/';
                    }
                }
            }


               
                TraceBack(Matrix, sequence1, sequence2);
                return 1;
        }
        static int MatchChars(char first, char second )
        {
            if (first == second)
                return Match;
            else
                return MissMatch;
        }
        static Cell[,] Initialize(Cell[,] Matrix, int stopDiagonal)
        {


            for (int i = 0; i <= stopDiagonal;i++ )
            {
                Matrix[0, i].Score = i * Gap;
                Matrix[0, i].Direction = '<';

                Matrix[i, 0].Score = i * Gap;
                Matrix[i, 0].Direction = '^';
            }

            int j = 1;
            for (int i = stopDiagonal+1; i < Matrix.GetLength(0);i++)
            {
                Matrix[i, j].Score = i * Gap;
                Matrix[i, j].Direction = '/';

                Matrix[j, i].Score = i * Gap;
                Matrix[j, i].Direction = '/';

                j++;
            }

            Matrix[0, 0].Score = 0;
            Matrix[0, 0].Direction = '*';

            return Matrix;
        }
        static void TraceBack(Cell[,] Matrix, string sequence1,string sequence2)
        {
            string alignedSeq1 = "";
            string alignedSeq2 = "";

            int i = Matrix.GetLength(0)-1;
            int j = Matrix.GetLength(1)-1;


                while (j > 0 && i>0) 
                {
                    if(Matrix[i,j].Direction == '/')
                    {
                        alignedSeq1 += sequence1[j - 1];
                        alignedSeq2 += sequence2[i - 1];
                        i--;
                        j--;
                    }
                    else if(Matrix[i,j].Direction == '^')
                    {
                        alignedSeq1 += '_';
                        alignedSeq2 += sequence2[i - 1];
                        i--;
                        
                    }
                    else if (Matrix[i, j].Direction == '<')
                    {
                        alignedSeq1 += sequence1[j - 1];
                        alignedSeq2 += '_';
                        j--;
                    }
                }

            string orderedAlignment1 = "", orderedAlignment2 = "";
            for (i = alignedSeq1.Length - 1; i >= 0; i--)
            {
                orderedAlignment1 += alignedSeq1[i];
                orderedAlignment2 += alignedSeq2[i];
            }

            Console.Write("{0}|", orderedAlignment1);
            Console.Write("{0}|", orderedAlignment2);
        }
    }
}
